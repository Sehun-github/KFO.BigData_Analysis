> # Excel을 이용한 데이터 분석

* 데이터를 의심하고 검증하라(데이터가 분석 바람직한지 확인 필요)
```
조건  1) 정형? 비정형?
      2) 일반 데이터 범위인지, 표 개체인지 판단 (셀 찍고 리본메뉴에 표도구 뜨면 표 개체)
      
	 표개체 장점
	1. 동적범위로 자동으로 계산해준다
	2. 필드 단위 계산 : 구조적 참조 (계산속도가 훨씬 빠르다)
	3. 슬라이서 및 요약 (디자인 메뉴에 있음)
	   - 필터링 및 요약이 훨씬 간편화

      3) 데이터가 구조화가 되어 있는지 확인 (*가장 어렵)
	  - 헤더 필드명 는 셀병합 없이 첫번째 행에만 입력
 	  - 아래방향으로 데이터가 쌓여 있는지 확인
  	- 중복이 발생해도 비워두지 말고 입력

      4) 필드별 데이터 타입 확인
	    - 숫자, 문자, 날짜, 수식
  ```
## day1
* [표 개체](data/표개체_이해.xlsx) 
  - 범위 -> 표  (ctrl+T, 삽입에서 표)
  - 표 -> 범위 (표도구 메뉴에서 범위로 변환) 
  - 마지막행에 요약행이 생김.
* [웹 스크래핑](data/웹스캐리핑.xlsx) 
  - 데이터 -> 새쿼리 -> 기타 원본에서 -> 웹에서 -> url확인 -> 편집 
* [파일 & 시트통합](data/시트통합.xlsx)  
  - 파일 통합 : 데이터 -> 새쿼리 -> 파일에서 -> 폴더에서 -> 결합(시트 이름이 같이야함)
  - 시트 통합 : 데이터 -> 새쿼리 -> 파일에서 > 통합 문서에서 -> 각 시트 or 시트통합 선택 -> Data 열에서 마우스 오른쪽 다른열 제거 -> 확장 
* [Cross Table](data/Cross_Table.xlsx)
  - 테이블 쿼리편집 -> Year에서 마우스 오른쪽 다른열 피벗 해제
* [UNION](data/Union.xlsx) 
  - 테이블 쿼리편집 -> 닫기 및 다음으로 로드 -> 연결만 만들기 -> 데이터 쿼리표시 -> 첫 쿼리 마우스 오른쪽 추가 -> 테이블 추가 
## day2
* [JOIN](data/Join.xlsx) 
  - 조인 종류 : Left JOIN, Right JOIN, Outer JOIN, Inner JOIN, Left Empty JOIN, Reft Empty JOIN   
  - 표1&표2 : 테이블 쿼리편집 -> 연결 전용 -> 병합 -> 같은 열 선택(*데이터 타입이 반드시 같아야 한다) -> 조인 종류 선택 -> 표2 테이블 확장 -> 닫기 및 로드   
	    예외) Outer JOIN : 표2 테이블 확장 후 -> 열추가 - 조건열 -> 조건에 맞춰 열 추가 -> 닫기 및 로드   

* [Pivot Table을 이용한 시각적 분석 01](data/Roaming_2102.xlsx) 
  - 문제) 연령대별, 대륙별 21년 2월 인천공항에서 가장 많이 출국 했을까??
  - raw data -> 파워쿼리 편집 -> 워크시트로 로드 -> 기본 분석:pivot table -> 리본 메뉴 - 삽입 - 피벗테이블 -> 시각적 분석(가독성)
```
    * 피벗 테이블을 통한 시각적 분석 방법
    1. 행/열/값에 해당하는 열 삽입 -> 디자인 -> 보고서 레이아웃 -> 테이블 형식(행,열 레이블 이름 바뀜)
    2. 정적분석 : 피벗 테이블 내 셀 클릭 -> 홈 -> 조건부 서식 -> 규칙관리 -> 새규칙 -> 규칙 설정
    3. 동적분석 : 피벗 테이블 내 셀 클릭 -> 분석 -> 슬라이서삽입 -> 보기 메뉴-눈금선 제거
```

* [Pivot Table을 이용한 시각적 분석 02](data/Dashboard.xlsx) 

  - raw data -> 조인 -> 워크시트로 다음으로 로드 ->  데이터모델에 이 데이터 추가 선택 -> 피벗테이블
```
  * 피벗 차트를 통한 시각적 분석 방법 
      1. 삽입 -> 피벗 차트 도구 -> 분석 -> 이 통합의 데이터 모델 사용 -> 피벗 차트 그리기 (정적 분석)
       - 분석 -> 필드 단추 추가 -> 모두 숨기기
       - 계열 겹치기: 0%, 간격 너비: 100% (막대 차트)
      2. 삽입 -> 슬라이서 (동적분석)
     > 차트 및 슬라이서 크기조정 : 크기 및 속성 -> 속성 -> 변하지 않음
     > 화면 한눈에 보기 : 페이지 레이아웃 - 너비:1페이지, 높이:1페이지, 용지방향:가로
```
## day3
* [Open API를 이용한 시각적 분석](data/실업급여현황.xlsx) 
  - 경기도 군포시, 23년 1,2월 남여별, 25~29세 사이의 실업급여 현황 시각적분석

* [단순 회귀 분석](data/단순회귀분석.xlsx) 
  - 단순 회귀분석 - 독립변수 1개, 종속변수 1개 (회귀식: Y = aX+b)
  - 분석도구 가져오기 : 개발도구 -> Excel 추가기능 -> 분석도구 팩 or 분석도구
```
   1. 산포도 작성 : 두 변수 간에 서로 상관관계가 있는지 대략 시각적으로 파악 
   	    - 삽입 -> 분산형 차트 -> 데이터 계열 마우스 오른쪽 - 추세선 추가 -> 수식을 차트에 표시 체크, R-제곱 값을 차트에 체크
   2. 상관분석 : 데이터 - 데이터 분석 -> 상관분석 (결정계수 R-제곱 값을 알아 낼수 있다.)
   3. 회귀분석 : 데이터 - 데이터 분석 -> 회귀분석 (회귀식을 알아 낼수 있다)
```

* [VBA 기초](data/개체모델.xlsm) 
  - 순서: application > workbooks(파일이름) > worksheets(시트이름) > range/cells
 ```
 ※ VBE 환경설정
	○ 개발도구 -> Visual Basic or 시트에서 코드보기 or Alt+F11
	○ 보기 -> 프로젝트 탐색기, 속성 창, 코드 창 실행 
	○ 보기 -> 도구모음 -> 표준,편집 체크
	○ 도구 -> 옵션 -> 변수선언요구 체크, 편집기 형식 - 나눔고딕코딩(한글) 없으면 다운
	
	sub 프로시저명() - 매크로 파일의 최소 단위
	프로시저 사용 명령어 -> F5
	한줄씩 실행 -> F8
	' -> 주석처리
	모듈 만들기 : 프로젝트 마우스 오른쪽 -> 삽입 - 모듈
```

## day4
* [VBA Range기본&메서드&속성](data/Range_개체.xlsm) 
* [VBA With&변수활용](data/with_변수.xlsm) 
```
 * 처리속도를 높이는 방법
  - with문
  - 변수활용
  - 배열변수
  - 엑셀기능활용

 * 변수 : 값을 저장
  1. 일반변수 - 변수에 들어온 값이 숫자, 문자, 날짜, 논리값
  2. 개체변수 - 엑셀의 개체(셀,시트,파일,피벗테이블,차트..)를 변수로 받음
  3. 배열변수
  4. 사용자 지정변수

* 변수 정의 방법
dim 변수 as 타입
```
* [VBA 변수검증](data/변수검증.xlsm) 
```
 - 일반변수에 들어온 값 확인하기 (4가지)
   • F8 + 마우스포인터
   • MsgBox
   • Debug.Print +직접실행창
   • 지역창 or 조사식창
 
 - 개체변수에 들어온 값 확인하기 (2가지)
   • .select
   • 조사식창(중단점 필수)
```
* [VBA 조건문 & 반복문](data/평가표.xlsm)
```
 * 실무버전 업그레이드
  1. 매크로 버튼으로 빼기
  2. 마지막행을 변수로 받아 활용
  3. 전 데이터 삭제
  4. 화면 업데이트 멈추기 Application.ScreenUpdating = False/True
  5. 처리속도 체크 - Timer 메서드
```
* [VBA 구구단](data/구구단.xlsm) 

## day5
* [VBA 구구단2](data/구구단2.xlsm)
```
- mod
ex) 4 mod 2 = 0
```
* [VBA 기본색상표](data/VBA기본색상표.xlsm)
* [VBA 회귀분석](data/회귀분석.xlsm)
```
 * VBA 매크로
  1. 일반 매크로: 처음부터 끝까지 코딩 
  2. 자동 매크로: 엑셀 워크시트 창에서 메뉴클릭을 통해 작업하는 과정을 엑셀이 자동으로 vba코드로 바꿔주는 매크로 
     - 처리속도가 느리다
     - 자동 매크로로 기록이 안되는 작업들이 많다
```
* [VBA 행삭제](data/행삭제.xlsm)
  - For ~ Next 반복문을 거꾸로 사용
  
## day6
* [VBA 함수](data/숫자추출.xlsm)
  - vba 함수 : 워크시트 함수, vba 함수
* [VBA 피벗테이블&피벗테이블](data/VBA_피벗테이블,차트.zip)
  - 고객 세그먼트별, 지역별 매출 합계 구하기

